(()=>{"use strict";var e={7673:(e,t,r)=>{r(3792),r(3362),r(9085),r(9391);var a=r(2893),n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},o=[];const s={name:"App"},l=s;var i=r(1656),u=(0,i.A)(l,n,o,!1,null,null,null);const c=u.exports;var p=r(173),m=(r(5276),function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-page"},[t("div",{staticClass:"login-box"},[t("h2",{staticClass:"logo"},[e._v("🚇 서울 지하철 관제")]),t("div",{staticClass:"form-group"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",placeholder:"사번 (8자리)"},domProps:{value:e.username},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login.apply(null,arguments)},input:function(t){t.target.composing||(e.username=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",placeholder:"비밀번호"},domProps:{value:e.password},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login.apply(null,arguments)},input:function(t){t.target.composing||(e.password=t.target.value)}}})]),e.error?t("p",{staticClass:"error-message"},[e._v(e._s(e.error))]):e._e(),t("button",{on:{click:e.login}},[e._v("로그인")])])])}),d=[],f=r(9217),v=r(4634),h=(r(4114),r(4335));const b={name:"LoginView",data:function(){return{username:"",password:"",error:""}},methods:{login:function(){var e=this;return(0,v.A)((0,f.A)().m(function t(){var r,a;return(0,f.A)().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,h.A.post("http://192.168.56.1:5000/api/login",{username:e.username,password:e.password});case 1:r=t.v,200===r.status&&r.data.department?(localStorage.setItem("user_department",r.data.department),e.$router.push("/dashboard")):e.error="로그인에 성공했으나 부서 정보가 없습니다.",t.n=3;break;case 2:t.p=2,a=t.v,a.response&&a.response.data&&a.response.data.message?e.error=a.response.data.message:e.error="로그인 실패. 서버 또는 네트워크 연결을 확인하세요.";case 3:return t.a(2)}},t,null,[[0,2]])}))()}}},g=b;var y=(0,i.A)(g,m,d,!1,null,"495383f0",null);const _=y.exports;r(2010);var w=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("aside",{staticClass:"sidebar"},[t("h2",{staticClass:"logo"},[e._v("🚇 서울 지하철 관제")]),t("ul",e._l(e.menuItems,function(r){return t("li",{key:r.name,class:{active:e.category===r.name},on:{click:function(t){return e.setCategory(r.name)}}},[e._v(" "+e._s(r.label)+" ")])}),0)]),t("main",{staticClass:"main"},[t("header",{staticClass:"topbar"},[t("h1",[e._v(e._s(e.topbarTitle))]),t("button",{on:{click:e.logout}},[e._v("로그아웃")])]),e.category?t("section",{staticClass:"dashboard"},[t("iframe",{attrs:{src:e.dashboardUrl,frameborder:"0",width:"100%",height:"100%"}})]):t("section",{staticClass:"alerts"},[t("h3",[e._v("🚨 실시간 경고 알림")]),t("ul",e._l(e.filteredAlerts,function(r,a){return t("li",{key:a},[t("span",{staticClass:"time"},[e._v(e._s(e.formatTime(r.alarm["@timestamp"])))]),t("span",{staticClass:"status"},[e._v(e._s(r.alarm["상태"]))]),t("span",{staticClass:"location"},[e._v(e._s(r.alarm["위치"]))]),t("span",{staticClass:"desc"},[e._v(" ["+e._s(r.alarm["equipment_id"])+"] "+e._s(r.alarm["시설"])+" - "+e._s(r.alarm["이벤트"])+" ")])])}),0)])])])},k=[];r(2008),r(1629),r(3609),r(3288),r(8111),r(2489),r(7588),r(9432),r(6099),r(2762),r(3500);const C={data:function(){return{userDepartment:null,category:null,alerts:[],socket:null,departmentMap:{control:{label:"종합",url:"http://192.168.56.1:5601/goto/OVERALL_DASHBOARD_ID",team:null},fire:{label:"소방",url:"http://192.168.56.1:5601/goto/2b6e15b0-5e1e-11f0-b853-af82cbb5aa36",team:"fire_safety_team"},electrical:{label:"전기",url:"http://192.168.56.1:5601/goto/3a5ba600-5e1e-11f0-b853-af82cbb5aa36",team:"electrical_team"},telecom:{label:"통신",url:"http://192.168.56.1:5601/goto/40bf6400-5e1e-11f0-b853-af82cbb5aa36",team:"communication_team"}}}},computed:{menuItems:function(){var e=this,t=[{name:null,label:"실시간 알림"}];if("control"===this.userDepartment)Object.keys(this.departmentMap).forEach(function(r){"control"!==r&&t.push({name:r,label:e.departmentMap[r].label})});else if(this.departmentMap[this.userDepartment]){var r=this.departmentMap[this.userDepartment];t.push({name:this.userDepartment,label:r.label})}return t},filteredAlerts:function(){var e;if("control"===this.userDepartment)return this.alerts;var t=null===(e=this.departmentMap[this.userDepartment])||void 0===e?void 0:e.team;return t?this.alerts.filter(function(e){return e.alarm.team===t}):[]},topbarTitle:function(){var e;return this.category?(null===(e=this.departmentMap[this.category])||void 0===e?void 0:e.label)||"대시보드":"실시간 경고 알림"},dashboardUrl:function(){var e;return null===(e=this.departmentMap[this.category])||void 0===e?void 0:e.url}},created:function(){var e,t=null===(e=localStorage.getItem("user_department"))||void 0===e?void 0:e.trim();t&&this.departmentMap[t]?this.userDepartment=t:(alert("부서 정보가 유효하지 않습니다. 다시 로그인해주세요."),this.$router.push("/"))},mounted:function(){var e=this,t=new WebSocket("ws://192.168.56.1:8001/ws");t.onopen=function(){return console.log("✅ WebSocket 연결됨")},t.onmessage=function(t){var r=JSON.parse(t.data);"심각"!==r["상태"]&&"경고"!==r["상태"]||(e.alerts.unshift({alarm:r}),e.alerts.length>10&&e.alerts.pop())},t.onerror=function(e){return console.error("❌ WebSocket 에러:",e)},t.onclose=function(){return console.log("❌ WebSocket 닫힘")}},methods:{setCategory:function(e){this.category=e},formatTime:function(e){var t=new Date(e);return t.toLocaleString("ko-KR",{hour12:!1})},logout:function(){localStorage.removeItem("user_department"),this.$router.push("/")}}},O=C;var A=(0,i.A)(O,w,k,!1,null,"2b2261b2",null);const S=A.exports;var x=[{path:"/",name:"login",component:_},{path:"/dashboard",name:"dashboard",component:S}],D=new p.Ay({mode:"history",base:"/",routes:x});const M=D;a.Ay.config.productionTip=!1,a.Ay.use(p.Ay),new a.Ay({router:M,render:function(e){return e(c)}}).$mount("#app")}},t={};function r(a){var n=t[a];if(void 0!==n)return n.exports;var o=t[a]={exports:{}};return e[a].call(o.exports,o,o.exports,r),o.exports}r.m=e,(()=>{var e=[];r.O=(t,a,n,o)=>{if(!a){var s=1/0;for(c=0;c<e.length;c++){for(var[a,n,o]=e[c],l=!0,i=0;i<a.length;i++)(!1&o||s>=o)&&Object.keys(r.O).every(e=>r.O[e](a[i]))?a.splice(i--,1):(l=!1,o<s&&(s=o));if(l){e.splice(c--,1);var u=n();void 0!==u&&(t=u)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[a,n,o]}})(),(()=>{r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}})(),(()=>{r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{var e={524:0};r.O.j=t=>0===e[t];var t=(t,a)=>{var n,o,[s,l,i]=a,u=0;if(s.some(t=>0!==e[t])){for(n in l)r.o(l,n)&&(r.m[n]=l[n]);if(i)var c=i(r)}for(t&&t(a);u<s.length;u++)o=s[u],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(c)},a=self["webpackChunksubway_frontend"]=self["webpackChunksubway_frontend"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=r.O(void 0,[504],()=>r(7673));a=r.O(a)})();
//# sourceMappingURL=app.408cec96.js.map